

\documentclass[8pt,a4paper,spanish,openany]{article}
\usepackage[utf8]{inputenc}
\usepackage{ifpdf}
\usepackage{enumitem}
\usepackage{multicol}
\usepackage{setspace}
\usepackage[top=3cm,left=3cm,right=3cm,bottom=3cm,a4paper]{geometry}
\usepackage{longtable}
\usepackage[spanish]{babel}
\usepackage{ifthen}


\newcommand{\Width}{\textwidth}
\newcommand{\HalfWidth}{0.5\textwidth}
\newcommand{\Height}{0.95\textheight}
\newcommand{\HalfHeight}{0.45\textheight}


\newcommand{\HalfHorizontalLine}
{
  \noindent\makebox[\linewidth]{\rule{\HalfWidth}{0.4pt}}
}

\newcommand{\HorizontalLine}
{
  \noindent\makebox[\linewidth]{\rule{\Width}{0.4pt}}
}

\newcommand{\IndentOn}{\setlength{\parindent}{12pt}}
\newcommand{\IndentOff}{\setlength{\parindent}{0pt}}

\newcounter{QuestionCounter}
\setcounter{QuestionCounter}{1}

\newenvironment{QuestionnaireQuestions}
{
  \begin{small}
    \setlength{\columnsep}{1cm}
    \begin{multicols}{2}
}
{
    \end{multicols}
  \end{small}
  \newpage
}

\newenvironment{QuestionnaireQuestion}[1][]
{
  \begin{minipage}{\HalfWidth}
    \HorizontalLine\\
    \arabic{QuestionCounter}. #1
    \begin{enumerate}[label=\alph*)]
}
{
    \end{enumerate}
  \end{minipage}

  \stepcounter{QuestionCounter}
}

\newcommand{\Answer}[1]{
  \item #1
}

\newenvironment{OpenQuestion}
{

  \begin{minipage}[t][\HalfHeight][t]{\Width}
    \HorizontalLine
    \arabic{QuestionCounter}.
}
{
    \vfill
  \end{minipage}
  \stepcounter{QuestionCounter}
  \\
}

\newenvironment{FullPageOpenQuestion}
{
  \clearpage
  \begin{minipage}[t][\Height][t]{\Width}
    \HorizontalLine
    \arabic{QuestionCounter}.
}
{
    \vfill
  \end{minipage}
  \stepcounter{QuestionCounter}
  \\
}


\newcommand{\Solution}[1]
{
  \ifpdf
    \pdfinfo{
      /Author (Alvaro Gonzalez Sotillo)
      /Title (Examen a partir de fichero GIFT y Latex, con Scala)
      /Keywords (PDF;LaTeX)
      /Subject (#1)
    }
  \fi
}

\newcommand{\Instructions}[2]
{
  \begin{small}
    Instrucciones generales para las preguntas cerradas:
    \begin{itemize}
      \item Marca solamente la respuesta más apropiada en cada caso, en la tabla de respuestas.
      \item No se tendrán en cuenta anotaciones fuera de la tabla de respuestas.
      \item Todas las preguntas tienen el mismo valor.
      \item Hay una, y sólo una, respuesta correcta en cada pregunta.
      \item Responde solamente las preguntas en las que estés seguro. Una respuesta incorrecta resta un tercio del valor de una respuesta acertada. Una pregunta sin responder no resta puntos.
    \end{itemize}

    Instrucciones generales para las preguntas abiertas:
    \begin{itemize}
      \item Es necesario responder a la pregunta y justificar dicha respuesta.
      \item Todas las preguntas tienen el mismo valor.
    \end{itemize}
    Puntuación:
    \begin{itemize}
      \item La parte tipo test es un  #1\% de la nota.
      \item La parte de preguntas abiertas es un #2\% de la nota.
      \item Se necesita un mínimo de 3,5 en cada parte del examen para que hagan media.
    \end{itemize}
  \end{small}
}

\usepackage{fancybox}
\newcommand{\StudentData}
{
  \newsavebox{\fmboxx}
  \begin{lrbox}{\fmboxx}
    \begin{minipage}{\Width}
      \vspace{0.2cm}
      \large{
        \textbf{Nombre} \\
        \textbf{Grupo} \\
        \textbf{Fecha}
      }
      \vspace{0.2cm}
    \end{minipage}
  \end{lrbox}
  \shadowbox{\usebox{\fmboxx}}
  \\
}

\newcommand{\ForLoop}[5][1]%
{%
\setcounter{#2}{#3}%
\ifthenelse{#4}%
{%
\addtocounter{#2}{#1}%
#5%
\ForLoop[#1]{#2}{\value{#2}}{#4}{#5}%
}%
{%
}%
}%


\newcommand{\AnswerTable}[1]
{
  \vspace{0.5cm}

  \setlength{\columnsep}{1cm}

  \newcommand{\AnswerWidth}{1.8cm}
  \newcommand{\QuestionFill}{}

  \newcounter{AnswerCounter}
  \begin{tabular}{|r|p{\AnswerWidth}|r|p{\AnswerWidth}|r|p{\AnswerWidth}|r|p{\AnswerWidth}|r|p{\AnswerWidth}|}
    \hline
    \ForLoop[5]{AnswerCounter}{1}{\value{AnswerCounter}<#1}{\arabic{AnswerCounter} & \QuestionFill & \arabic{AnswerCounter} & \QuestionFill & \arabic{AnswerCounter} & \QuestionFill  & \arabic{AnswerCounter} & \QuestionFill & \arabic{AnswerCounter} & \QuestionFill \\ \hline}
  \end{tabular}


  \newpage

}


\begin{document}


\IndentOff

\StudentData


${GeneratedContent}


\end{document}
